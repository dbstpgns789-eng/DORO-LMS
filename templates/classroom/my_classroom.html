{% extends "base.html" %}
{% load static %}

{% block title %}ë‚´ ê°•ì˜ì‹¤ | DORO LMS{% endblock %}

{% block extra_css %}
<style>
  .classroom-container {
    display: flex;
    min-height: calc(100vh - 200px);
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
    gap: 20px;
  }

  /* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */
  .sidebar {
    width: 250px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 20px;
    height: fit-content;
  }

  .sidebar-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid #4650D5;
  }

  .sidebar-header h2 {
    font-size: 18px;
    font-weight: 600;
    margin: 0;
  }

  .sidebar-menu {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-menu li {
    margin-bottom: 5px;
  }

  .sidebar-menu a {
    display: block;
    padding: 12px 15px;
    color: #333;
    text-decoration: none;
    border-radius: 5px;
    transition: all 0.2s;
    font-size: 14px;
  }

  .sidebar-menu a:hover {
    background-color: #f0f0f0;
  }

  .sidebar-menu a.active {
    background-color: #4650D5;
    color: white;
    font-weight: 600;
  }

  /* ë©”ì¸ ì½˜í…ì¸  */
  .main-content {
    flex: 1;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 30px;
  }

  .content-header {
    margin-bottom: 30px;
  }

  .content-header h1 {
    font-size: 24px;
    font-weight: 600;
    margin: 0 0 10px 0;
  }

  .content-header p {
    color: #666;
    margin: 0;
  }

  /* ê°•ì˜ í…Œì´ë¸” */
  .course-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid #e0e0e0;
  }

  .course-table thead {
    background-color: #FF69B4;
  }

  .course-table th {
    padding: 15px;
    text-align: center;
    color: white;
    font-weight: 600;
    border: 1px solid #FF1493;
  }

  .course-table tbody tr {
    border-bottom: 1px solid #e0e0e0;
  }

  .course-table tbody tr:hover {
    background-color: #f8f9fa;
  }

  .course-table td {
    padding: 15px;
    text-align: center;
    border: 1px solid #e0e0e0;
  }

  .course-tag {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    color: white;
  }

  .btn-enter {
    padding: 6px 16px;
    background-color: #4650D5;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    font-size: 13px;
  }

  .btn-enter:hover {
    background-color: #3640C5;
  }

  .btn-cancel {
    padding: 6px 16px;
    background-color: #999;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    font-size: 13px;
    margin-left: 5px;
  }

  .btn-cancel:hover {
    background-color: #777;
  }

  .empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #999;
  }

  .empty-state p {
    font-size: 16px;
    margin-bottom: 20px;
  }
</style>
{% endblock %}

{% block content %}
<div class="classroom-container">

  <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <span style="font-size: 24px;">ğŸ‘¤</span>
      <h2>{{ request.user.name }}</h2>
    </div>

    <ul class="sidebar-menu">
      <!-- ğŸ‘‡ ë©”ë‰´ ìˆ˜ì • -->
      <li><a href="{% url 'classroom:my_classroom' %}" class="active">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a></li>
      <li><a href="#">ğŸ“… ìº˜ë¦°ë”</a></li>
      <li><a href="{% url 'classroom:my_classroom' %}">ğŸ“š ê°•ì˜</a></li>
      <li><a href="#">ğŸ“ ë“±ë¡ ì‹ ì²­</a></li>

      {% if request.user.role == "instructor" or request.user.role == "manager" %}
      <li><a href="{% url 'course:course_create' %}">ğŸ« ê°•ì˜ ì¤€ë¹„ì‹¤</a></li>
      {% endif %}
    </ul>
  </aside>

  <!-- ë©”ì¸ ì½˜í…ì¸  -->
  <main class="main-content">
    <div class="content-header">
      <h1>ê°•ì˜ ëª©ë¡</h1>
      <p>í˜„ì¬ ìˆ˜ê°• ì¤‘ì¸ ê°•ì˜ë¥¼ í™•ì¸í•˜ê³  í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”</p>
    </div>

    <!-- ê°•ì˜ í…Œì´ë¸” -->
    {% if ongoing_courses %}
    <table class="course-table">
      <thead>
        <tr>
          <th style="width: 60px;">ë²ˆí˜¸</th>
          <th style="width: 120px;">ê°•ì˜ êµ¬ë¶„</th>
          <th>ê°•ì˜ëª…</th>
          <th style="width: 120px;">ê°•ì‚¬ëª…</th>
          <th style="width: 120px;">ìˆ˜ê°• ì‹œì‘ì¼</th>
          <th style="width: 100px;">ì§„ë„ìœ¨</th>
          <th style="width: 150px;">ê´€ë¦¬</th>
        </tr>
      </thead>
      <tbody>
        {% for enrollment in ongoing_courses %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>
            <span class="course-tag" style="background: {% cycle '#00BFA5' '#FF6B6B' '#4ECDC4' '#FFD93D' '#6C5CE7' '#A8E6CF' %};">
              ì¼ë°˜
            </span>
          </td>
          <td style="text-align: left; font-weight: 600;">
            <a href="{% url 'classroom:my_course_detail' enrollment.course.course_id %}" style="text-decoration: none; color: #333;">
              {{ enrollment.course.title }}
            </a>
          </td>
          <td>{{ enrollment.course.instructor.name }}</td>
          <td>{{ enrollment.enrolled_at|date:"Y/m/d" }}</td>
          <td>
            <strong style="color: #4650D5;">{{ enrollment.progress }}%</strong>
          </td>
          <td>
            <a href="{% url 'classroom:my_course_detail' enrollment.course.course_id %}" class="btn-enter">ì…ì¥</a>
            <a href="{% url 'classroom:unenroll' enrollment.enrollment_id %}"
               class="btn-cancel"
               onclick="return confirm('ìˆ˜ê°•ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ì·¨ì†Œ</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <div class="empty-state">
      <p style="font-size: 48px;">ğŸ“š</p>
      <p>ìˆ˜ê°• ì¤‘ì¸ ê°•ì˜ê°€ ì—†ìŠµë‹ˆë‹¤</p>
      <a href="{% url 'index' %}" class="btn-enter" style="padding: 12px 30px; font-size: 16px;">
        ê°•ì˜ ë‘˜ëŸ¬ë³´ê¸°
      </a>
    </div>
    {% endif %}

    <!-- ì œì¶œ ëŒ€ê¸° ì¤‘ì¸ ê³¼ì œ ì•Œë¦¼ -->
    {% if pending_assignments %}
    <div style="margin-top: 30px; padding: 20px; background-color: #FFF3CD; border-radius: 8px; border: 1px solid #FFE69C;">
      <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #856404;">
        â° ì œì¶œ ëŒ€ê¸° ì¤‘ì¸ ê³¼ì œ ({{ pending_assignments.count }}ê°œ)
      </h3>
      <ul style="list-style: none; padding: 0; margin: 0;">
        {% for assignment in pending_assignments %}
        <li style="padding: 10px 0; border-bottom: 1px solid #FFE69C;">
          <a href="{% url 'classroom:assignment_detail' assignment.assignment_id %}" style="text-decoration: none; color: #333;">
            <strong>{{ assignment.course.title }}</strong> - {{ assignment.title }}
            <span style="color: #dc3545; font-size: 14px; margin-left: 10px;">
              (ë§ˆê°: {{ assignment.due_date|date:"m/d H:i" }})
            </span>
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

  </main>

</div>
{% endblock %}
