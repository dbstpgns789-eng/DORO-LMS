{% extends "base.html" %}
{% load static %}

{% block title %}{{ question.title }} | ì§ˆë¬¸ ê²Œì‹œíŒ{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/question_detail.css' %}">
{% endblock %}

{% block content %}
<div class="q-detail-container">

  <a href="{% url 'classroom:my_course_detail' course.course_id %}" class="back-link">
    â† ê°•ì˜ì‹¤ë¡œ ëŒì•„ê°€ê¸°
  </a>

  <div class="q-box">
    <div class="q-header">
      <h2 class="q-title">{{ question.title }}</h2>

      {% if request.user == question.author or request.user == course.instructor %}
      <a href="{% url 'classroom:question_resolve' question.question_id %}"
         class="btn-status {% if question.is_resolved %}resolved{% else %}unresolved{% endif %}">
        {% if question.is_resolved %}ë¯¸í•´ê²°ë¡œ ë³€ê²½{% else %}âœ… í•´ê²°ë¨ í‘œì‹œ{% endif %}
      </a>
      {% endif %}
    </div>

    <div class="q-meta">
      <span>ğŸ‘¤ {{ question.author.name }}</span>
      <span>ğŸ“… {{ question.created_at|date:"Y.m.d H:i" }}</span>
      {% if question.is_resolved %}
      <span class="badge-resolved">âœ… í•´ê²°ë¨</span>
      {% endif %}
    </div>

    <div class="q-content">{{ question.content }}</div>
  </div>

  <h3 class="answer-section-title">ğŸ’¬ ë‹µë³€ ({{ answers.count }}ê°œ)</h3>

  {% for answer in answers %}
  <div class="answer-item {% if answer.is_instructor_answer %}instructor{% else %}normal{% endif %}">
    <div class="answer-header">
      <span class="answer-author">
        {{ answer.author.name }}
        {% if answer.author == course.instructor %}
          <span class="instructor-badge">(ê°•ì‚¬)</span>
        {% endif %}
      </span>
      <span class="answer-date">{{ answer.created_at|date:"Y.m.d H:i" }}</span>
    </div>
    <div class="answer-content">{{ answer.content }}</div>
  </div>
  {% empty %}
  <p class="empty-answers">ì•„ì§ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endfor %}

  <div class="answer-form-box">
    <h4 class="answer-form-title">ë‹µë³€ ì‘ì„±</h4>
    <form method="post">
      {% csrf_token %}
      {{ form.content }}
      <button type="submit" class="btn-submit">ë‹µë³€ ë“±ë¡</button>
    </form>
  </div>

</div>
{% endblock %}