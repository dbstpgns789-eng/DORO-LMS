{# templates/registration/password_reset_confirm.html (또는 설정된 경로) #}
{% extends "base.html" %}
{% load static %}

{% block title %}새 비밀번호 설정 | DORO LMS{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/password_reset_confirm.css' %}">
{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero-inner">
  </div>
</section>

<main class="card-wrap">
  <div class="card-inner">

    <section class="reset-card">
      <div class="logo-row">
        <img src="{% static 'img/doro_logo.png' %}" alt="DORO 로고" class="brand-badge">
        <span class="logo-text"><b>DORO</b> | LMS</span>
      </div>

      {% if validlink %}
        <h2 class="headline">새 비밀번호 설정</h2>
        <p class="lead">
          새로운 비밀번호를 두 번 입력해 주세요.<br>
          안전한 비밀번호를 사용하면 계정을 더 안전하게 보호할 수 있습니다.
        </p>

        <form method="post" class="reset-form">
          {% csrf_token %}
          {{ form.non_field_errors }}

          <div class="field">
            <label for="{{ form.new_password1.id_for_label }}">새 비밀번호</label>
            {{ form.new_password1 }}
            {% if form.new_password1.help_text %}
              <p class="help">{{ form.new_password1.help_text|safe }}</p>
            {% endif %}
            {{ form.new_password1.errors }}
          </div>

          <div class="field">
            <label for="{{ form.new_password2.id_for_label }}">새 비밀번호 확인</label>
            {{ form.new_password2 }}
            {{ form.new_password2.errors }}
          </div>

          <div class="cta">
            <button type="submit" class="btn-primary">비밀번호 변경하기</button>
          </div>
        </form>

      {% else %}
        <h2 class="headline error">링크가 유효하지 않습니다</h2>
        <p class="lead">
          이 비밀번호 재설정 링크는 이미 사용되었거나 만료되었습니다.<br>
          다시 비밀번호 재설정을 요청해 주세요.
        </p>

        <div class="cta">
          <a href="{% url 'user:password_reset' %}" class="btn-primary btn-outline">
            비밀번호 재설정 다시 요청하기
          </a>
        </div>
      {% endif %}
    </section>

  </div>
</main>
{% endblock %}
