{% extends "base.html" %}
{% load static %}

{% block title %}아이디(이메일) 찾기 | DORO LMS{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/find_id.css' %}">
<style>
  /* * [수정됨] 레이아웃 깨짐 방지 스타일 추가
   * 기존 CSS 파일의 고정 높이 설정을 덮어쓰기(override) 합니다.
   */
  .result-box {
    height: auto !important;       /* 고정 높이 해제: 내용물만큼 늘어남 */
    min-height: 200px;             /* 최소 높이 보장 */
    padding: 40px 20px;            /* 내부 여백 넉넉하게 */
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    box-sizing: border-box;        /* 패딩 포함 크기 계산 */
  }

  .result-actions {
    margin-top: 30px;              /* 텍스트와 버튼 사이 간격 */
    display: flex;
    flex-direction: column;        /* 버튼을 세로로 배치 */
    gap: 10px;                     /* 버튼 사이 간격 */
    width: 100%;
  }

  .result-actions .btn-primary,
  .result-actions .btn-secondary {
    width: 100%;                   /* 버튼 너비 꽉 차게 */
    display: block;
    text-align: center;
    box-sizing: border-box;
    padding: 12px 0;               /* 버튼 높이 확보 */
  }
</style>
{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero-inner">
  </div>
</section>

<main class="card-wrap">
  <div class="card-inner">

    <section class="find-card" aria-labelledby="find-id-title">
      <div class="logo-row">
        <img src="{% static 'img/doro_logo.png' %}" alt="DORO 로고" class="brand-badge">
        <span class="logo-text"><b>DORO</b> | LMS</span>
      </div>

      <h2 id="find-id-title" class="card-title">가입 정보로 아이디 찾기</h2>

      {% if not found_email %}
        <p class="card-desc">
          회원가입 시 입력하신 <strong>이름</strong>과 <strong>연락처(휴대폰)</strong>으로<br>
          DORO ID(이메일)를 찾아드립니다.
        </p>

        <form method="POST" action="{% url 'user:find_id' %}" class="find-form">
          {% csrf_token %}

          <div class="field">
            <label for="id_name">이름</label>
            <input
              type="text"
              id="id_name"
              name="name"
              placeholder="홍길동"
              required
            >
          </div>

          <div class="field">
            <label for="id_phone_number">연락처(휴대폰)</label>
            <input
              type="text"
              id="id_phone_number"
              name="phone_number"
              placeholder="010-1234-5678"
              required
            >
            <p class="help">숫자와 '-'를 포함해 정확히 입력해주세요.</p>
          </div>

          <button type="submit" class="btn-primary">아이디(이메일) 찾기</button>
        </form>
      {% endif %}

      {% if found_email %}
      <div class="result-box success" role="status">
        <p class="result-label">찾으신 DORO ID(이메일)는</p>
        <p class="result-email" style="font-size: 1.2rem; font-weight: bold; margin: 10px 0; color: #333;">
          {{ found_email }}
        </p>
        <p class="result-sub">보안상 일부만 마스킹된 이메일입니다.</p>

        <div class="result-actions">
          <a href="{% url 'user:login' %}" class="btn-primary">로그인 하러 가기</a>
          <a href="{% url 'index' %}" class="btn-secondary">홈으로</a>
        </div>
      </div>

      {% elif request.method == 'POST' %}
      <div class="result-box error" role="alert">
        <p class="result-label">일치하는 계정을 찾을 수 없습니다.</p>
        <p class="result-sub">
          이름과 연락처를 다시 확인해주세요.<br>
          다른 이메일로 가입하셨을 수도 있습니다.
        </p>
        <div class="result-actions">
          <a href="{% url 'user:find_id' %}" class="btn-secondary">다시 입력하기</a>
          <a href="{% url 'user:signup' %}" class="btn-primary">회원가입 하러 가기</a>
        </div>
      </div>
      {% endif %}

      <div class="sub-links">
        <a href="{% url 'user:password_reset' %}">비밀번호가 기억나지 않나요?</a>
      </div>

    </section>

  </div>
</main>
{% endblock %}