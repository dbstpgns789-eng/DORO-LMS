{% extends "base.html" %}
{% load static %}

{% block title %}{{ course.title }} | DORO LMS{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/course_detail.css' %}">
{% endblock %}

{% block content %}
<div class="course-detail">

  {% if user.is_authenticated %}
    {% if user.role == "manager" %}
    <div class="admin-buttons">
      <span class="admin-label">ğŸ“ ê°•ì˜ ê´€ë¦¬</span>

      <a href="{% url 'course:course_update' course.course_id %}" class="btn-edit">âœï¸ ìˆ˜ì •</a>

      {% if user.role == "manager" %}
      <a href="{% url 'course:course_delete' course.course_id %}" class="btn-delete">ğŸ—‘ï¸ ì‚­ì œ</a>
      {% endif %}

    </div>
    {% endif %}
  {% endif %}

  <div class="course-header">
    <h1 class="course-title">{{ course.title }}</h1>

    <div class="course-meta">
      <span>ğŸ‘¨â€ğŸ« ê°•ì‚¬: {{ course.instructor.name }}</span>
      <span>ğŸ“‚ ì¹´í…Œê³ ë¦¬: {{ course.get_category_display }}</span>
      <span>ğŸ‘ï¸ ì¡°íšŒìˆ˜: {{ course.views }}</span>
    </div>
  </div>

  <div class="course-info-box">
    <h3 style="margin-bottom: 15px; font-size: 20px; font-weight: 600;">ğŸ“‹ ê°•ì˜ ì •ë³´</h3>

    <div class="info-row">
      <span class="info-label">ğŸ“† ìˆ˜ê°• ê¸°ê°„</span>
      <span class="info-value">{{ course.start_date }} ~ {{ course.end_date }}</span>
    </div>

    <div class="info-row">
      <span class="info-label">ğŸ“… ê°•ì˜ ìš”ì¼</span>
      <span class="info-value">{{ course.get_weekday_display }}</span>
    </div>

    <div class="info-row">
      <span class="info-label">â° ê°•ì˜ ì‹œê°„</span>
      <span class="info-value">{{ course.start_time|date:"H:i" }} - {{ course.end_time|date:"H:i" }}</span>
    </div>

    <div class="info-row">
      <span class="info-label">ğŸ“š ë“±ë¡ì¼</span>
      <span class="info-value">{{ course.created_at|date:"Yë…„ mì›” dì¼" }}</span>
    </div>
  </div>

  {% if course.image %}
  <div class="course-image-wrap">
    <img src="{{ course.image.url }}" alt="{{ course.title }}" class="course-image">
  </div>
  {% endif %}

  <div class="course-description">
    <h3 class="desc-title">ğŸ“ ê°•ì˜ ì„¤ëª…</h3>
    <p class="desc-text">{{ course.description }}</p>
  </div>

  {% if user.is_authenticated %}
    {% if is_enrolled %}
      <a href="{% url 'classroom:my_classroom' %}" class="btn-enroll btn-enrolled">
        âœ… ìˆ˜ê°• ì¤‘ - ë‚´ ê°•ì˜ì‹¤ë¡œ ì´ë™
      </a>
    {% else %}
      {% if course.is_expired %}
        <span class="btn-enroll btn-disabled">
          â° ìˆ˜ê°• ê¸°ê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤
        </span>
      {% else %}
        <a href="{% url 'classroom:enroll' course.course_id %}" class="btn-enroll">
          ğŸ“š ìˆ˜ê°• ì‹ ì²­í•˜ê¸°
        </a>
      {% endif %}
    {% endif %}
  {% else %}
    <p style="color: #666; font-size: 16px;">ë¡œê·¸ì¸ í›„ ìˆ˜ê°• ì‹ ì²­ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
    <a href="{% url 'user:login' %}" class="btn-enroll">ë¡œê·¸ì¸í•˜ê¸°</a>
  {% endif %}

</div>
{% endblock %}